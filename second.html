<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Stock Transaction Table</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #121212;
      color: #e0e0e0;
      margin: 0;
      padding: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
      background-color: #1e1e1e;
    }

    th, td {
      border: 1px solid #333;
      padding: 8px 12px;
      text-align: center;
    }

    th {
      background-color: #333;
    }

    input {
      background-color: #2c2c2c;
      color: #e0e0e0;
      border: 1px solid #555;
      padding: 6px;
      width: 100%;
    }

    button {
      background-color: #6200ea;
      color: white;
      border: none;
      padding: 10px 20px;
      margin: 10px 0;
      cursor: pointer;
    }

    button:hover {
      background-color: #3700b3;
    }
  </style>
</head>
<body>

  <h1>Stock Transaction Table</h1>

  <form id="transaction-form">
    <table id="transaction-table">
      <thead>
        <tr>
          <th>Date</th>
          <th>Stock Name</th>
          <th>Buy/Sell</th>
          <th>Quantity</th>
          <th>Price</th>
        </tr>
      </thead>
      <tbody id="transaction-body">
        <tr>
          <td><input type="date" name="date" required></td>
          <td><input type="text" name="stock" required></td>
          <td>
            <select name="type" required>
              <option value="buy">Buy</option>
              <option value="sell">Sell</option>
            </select>
          </td>
          <td><input type="number" name="quantity" min="1" required></td>
          <td><input type="number" name="price" step="0.01" required></td>
        </tr>
      </tbody>
    </table>

    <button type="button" onclick="addRow()">Add Row</button>
    <button type="submit">Submit</button>
  </form>

  <script>
    function addRow() {
      const tbody = document.getElementById('transaction-body');
      const newRow = document.createElement('tr');
      newRow.innerHTML = `
        <td><input type="date" name="date" required></td>
        <td><input type="text" name="stock" required></td>
        <td>
          <select name="type" required>
            <option value="buy">Buy</option>
            <option value="sell">Sell</option>
          </select>
        </td>
        <td><input type="number" name="quantity" min="1" required></td>
        <td><input type="number" name="price" step="0.01" required></td>
      `;
      tbody.appendChild(newRow);
    }

    document.getElementById('transaction-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const rows = document.querySelectorAll('#transaction-body tr');
      const data = [];

      rows.forEach(row => {
        const date = row.querySelector('input[name="date"]').value;
        const stock = row.querySelector('input[name="stock"]').value;
        const type = row.querySelector('select[name="type"]').value;
        const quantity = row.querySelector('input[name="quantity"]').value;
        const price = row.querySelector('input[name="price"]').value;

        data.push({ date, stock, type, quantity, price });
      });

      fetch('https://n8n.macandcode.cloud/webhook/773deda6-756a-4224-84a8-90dcc2e72438', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ transactions: data })
      })
      .then(res => {
        if (!res.ok) throw new Error("Server responded with status " + res.status);
        alert('Submitted successfully!');
      })
      .catch(err => {
        alert('Submission failed: ' + err.message);
        console.error(err);
      });
    });
  </script>

</body>
</html>
